---
layout: default
title: Composite monitors
nav_order: 3
parent: Alerting
has_children: false
redirect_from:
---

# Composite monitors

---

#### Table of contents
- TOC
{:toc}

---

## About composite monitors

Basic [monitor types]({{site.url}}{{site.baseurl}}/observing-your-data/alerting/monitors/#monitor-types) for the Alerting plugin are designed to define a single trigger type. For example, a document level monitor can trigger an alert based on a query's match with documents, while a bucket level monitor can trigger an alert based on queries aimed at aggregated values in a data source. The composite monitor extends the usefulness of the individual monitor types by providing functionality that can chain the output of multiple monitor types into a single workflow that includes multiple triggers and permits analysis of a data source based on multiple criteria. This allows you to derive more granular information about a data source without requiring you to manually coordinate the scheduling of the separate monitors.

Composite monitors solve limitations with basic monitors in the following ways:

* Composite monitors give you the ability to create complex queries through a combination of triggers generated by multiple types of monitors.
* They have the capacity to define a pipeline of rules and queries that are run as a single execution.
* They can chain together individual monitors so that the output of one can act as the input for the next, repeating this through the entire sequence of the execution.
* They provide a more complete view of a given data source by running multiple monitors and multiple types of monitors in sequence, creating finer focused results and reducing noise in the results.

## Key terms

The key terms in the following table describe the basic concepts behind composite monitors. For additional terms common to all types of monitors, see [Key terms]({{site.url}}{{site.baseurl}}/observing-your-data/alerting/monitors/#key-terms) related to basic monitors.

| Term | Definition |
| :--- | :--- |
| Composite monitor | A combination of multiple individual monitors that includes functionality to execute each monitor in a sequence. The compound monitor can query different aspects of a dataset based on the type of monitors included in the composite monitor's definition.  |
| Delegate monitor | Any monitor of any monitor type used in the chained workflow of a compound monitor. Delegate monitors are executed sequentially according to their order in the monitor definition. |
| Findings chain | A sequence of findings where the findings for each monitor are used as the inputs for subsequent monitors. 
| Alert chain | A sequence of alerts where an alert for each monitor is used as the input for a subsequent monitor.  |
| Execution | A single run of all delegate monitors in the sequence defined in the composite monitor's configuration. |
| Execution schema | Conditions that, if met, generate *alerts*. |
| Execution Id | Allows for the management of data recorded from a specific execution. The execution Id associates findings and alerts with the execution and is stored in each monitor's metadata. |

## Example workflows

In a composite monitor, the outputs from the individual delegate monitors can be chained together to produce more focused results and more valuable analysis of the data source. These outputs include both findings and alerts. The folowing sections describe the workflow for each and provide an example of how they work.

### Chained findings

As an example of chained findings, consider a composite monitor configured with two delegate monitors. The second monitor is defined to use findings from the first as its input.

* The first, delegate monitor (monitor #1) is a per document monitor configured to analyze a data source with the following three queries:
   1. Request payload size greater than 100 Kb.
   2. Response status = 200.
   3. Response contains a specific header.
   For every execution, the monitor queries the data source and generates findings for documents that match the conditions set out by the queries. These results by themselves are valuable. However, by adding a second monitor the sequence can apply further analysis to events in the data source.
* The second monitor (monitor #2) is a per bucket monitor that aggregates data by client IP, checks how many IPs there are, and determines how many IPs are sending these types of requests. The composite monitor configuration provides a way to add the second monitor in sequence so that it executes following the first.
* Monitor #2 first filters the findings from Monitor #1 and then queries the data derived from Monitor #1. Matches with this second set of queries then generate triggers and alerts for notifications.

The following image shows the simplified workflow of this compound monitor.

{% include gif-pause.html %}

### Chained alerts




